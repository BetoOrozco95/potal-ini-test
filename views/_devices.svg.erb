<%
  large ||= true
  recolor ||= true
  icon ||= false
  contrast ||= false
  viewbox = large ? "0 0 360 216" : "0 0 108 108"
  bars ||= get_dialog_data(:device_session_summary)[:progress_bars][:bars]
  offset_multiple = large ? 17 : 9
  offset_base = large ? 16 : 28
  bar_height = large ? 7.5 : 5
  bar_width = large ? 65 : 55
  bar_start = large ? 17.5 : 22
%>

<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="<%= viewbox %>" class="mx-auto d-block <%= 'contrast' if contrast %> <%= 'icon' if icon %> <%= 'recolor-svg' if recolor %> ">
  <% if large %>
  	<path class="recolor-1" d="M289.4,2.6H69.8c-10.2,0-18.5,8.3-18.5,18.4v168.4h15.3l3.5-5.7h17.4l3.5,2.3h177.3l3.5-2.3h17.4
  		l3.5,5.7h15.3V21C307.8,10.9,299.6,2.6,289.4,2.6z M179.6,3.8c1.1,0,2,0.9,2,2c0,1.1-0.9,2-2,2c-1.1,0-2-0.9-2-2
  		C177.6,4.7,178.5,3.8,179.6,3.8z M303.4,170.3c0,2.1-1.7,3.9-3.9,3.9H60.3c-2.1,0-3.9-1.7-3.9-3.9V18.9c0-2.1,1.7-3.9,3.9-3.9
  		h239.2c2.1,0,3.9,1.7,3.9,3.9V170.3z"/>
  	<path class="recolor-1" d="M329.8,193.7H206.4c-1.9,0-3.5,1.1-3.5,2.3c0,0.3-0.6-1.7-1.3,0.6h-43.3
  		c-0.8-2.3-1.3-0.3-1.3-0.6c0-1.3-1.5-2.3-3.5-2.3H30.2c-1.9,0-3.5,1.1-3.5,2.3v4.1c0,0.1,0,0.2,0,0.3c0.4,4.2,7.2,6.6,12.8,6.6
  		h280.9c5.6,0,12.4-2.4,12.8-6.6c0-0.1,0-0.2,0-0.3v-4.1C333.3,194.8,331.7,193.7,329.8,193.7z M53.5,202.4c-1,0-1.8-0.8-1.8-1.9
  		c0-1,0.8-1.9,1.8-1.9c1,0,1.9,0.8,1.9,1.9C55.3,201.5,54.5,202.4,53.5,202.4z M62.3,202.4c-1,0-1.8-0.8-1.8-1.9
  		c0-1,0.8-1.9,1.8-1.9c1,0,1.8,0.8,1.8,1.9C64.1,201.5,63.3,202.4,62.3,202.4z M299.2,201.9h-8.9v-2.7h8.9V201.9z"/>
  <% else %>
    <path class="recolor-1" d="M84,24.7H23.2c-2.8,0-5.1,2.3-5.1,5.1v46.6h4.2l1-1.6h4.8l1,0.6h49.1l1-0.6h4.8l1,1.6h4.2V29.8
      C89.1,27,86.8,24.7,84,24.7z M53.6,26.3c0.6,0,1.1,0.5,1.1,1.1c0,0.6-0.5,1.1-1.1,1.1c-0.6,0-1.1-0.5-1.1-1.1
      C52.5,26.9,53,26.3,53.6,26.3z M84.3,69c0,0.5-0.4,1-1,1H23.8c-0.5,0-1-0.4-1-1V31.3c0-0.5,0.4-1,1-1h59.5c0.5,0,1,0.4,1,1V69z"/>
    <path class="recolor-1" d="M95.1,77.6H60.9c-0.5,0-1,0.4-1,1c0,0.1-0.2-0.7-0.4,0.3h-12c-0.2-1-0.4-0.1-0.4-0.3
      c0-0.5-0.4-1-1-1H12.1c-0.5,0-1,0.4-1,1v1.7c0,0,0,0.1,0,0.1c0.1,1.7,2,2.7,3.5,2.7h77.8c1.5,0,3.4-1,3.5-2.7c0,0,0-0.1,0-0.1
      v-1.7C96.1,78.1,95.6,77.6,95.1,77.6z M19.2,81c-0.6,0-1.1-0.5-1.1-1.2c0-0.6,0.5-1.2,1.1-1.2c0.6,0,1.2,0.5,1.2,1.2
      C20.3,80.4,19.8,81,19.2,81z M24.7,81c-0.6,0-1.2-0.5-1.2-1.2c0-0.6,0.5-1.2,1.2-1.2c0.6,0,1.1,0.5,1.1,1.2
      C25.8,80.4,25.3,81,24.7,81z M89.4,80.5h-5.3V79h5.3V80.5z"/>
  <% end %>
  <% offset = 0 %>
  <% bars.each do | bar | %>
    <% unless bar[:progress_bar_container_class] == 'progress-bar-hidden' %>
      <% if large %>
        <text x="<%= bar_start %>%" y="<%= (offset_base + offset * offset_multiple).to_s %>%" font-size="1rem" class="recolor-1"><%= bar[:columns][0].to_s %></text>
      <% end %>
      <rect x="<%= bar_start %>%" y="<%= (offset_base + 2 + offset * offset_multiple).to_s %>%" width="<%= bar_width.to_s %>%" height="<%= bar_height %>%" class="recolor-2" rx="<%= (bar_height - 2) / 2 %>%"  />
      <rect x="<%= bar_start %>%" y="<%= (offset_base + 2 + offset * offset_multiple).to_s %>%" width="<%= (bar[:percent].to_i * (bar_width.to_f / 100)).to_s %>%" height="<%= bar_height %>%" class="<%= bar[:bar_class] %>" rx="<%= (bar_height - 2) / 2 %>%"  />
      <% if large %>
        <text x="50%" y="<%= (offset_base + 8 + offset * offset_multiple).to_s %>%" font-size="0.8rem" text-anchor="middle" fill="#FFFFFF"><%= bar[:value] %></text>
      <% end %>
      <% offset += 1 %>
    <% end %>
  <% end %>
</svg>
